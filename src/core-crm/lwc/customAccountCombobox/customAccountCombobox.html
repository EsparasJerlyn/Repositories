<template>
  <div class="slds-form-element">
    <!-- Field Label -->
    <label if:true={fieldLabel} class={labelClass}> {fieldLabel} </label>
    <div class="slds-form-element_control">
      <!-- Combobox Container -->
      <div class="slds-combobox_container">
        <div
          class={dropDownClass}
          aria-expanded="true"
          aria-haspopup="listbox"
          role="combobox"
        >
          <div
            class="slds-combobox__form-element slds-input-has-icon slds-input-has-icon_right"
            role="none"
          >
            <!-- Readonly Input to display selected value -->
            <input
              type="text"
              class="slds-input slds-combobox__input slds-combobox__input-value combobox-input-class"
              id="select-sobject-id"
              autocomplete="off"
              data-id="select-sobject-id"
              aria-autocomplete="list"
              aria-controls="listbox-id-11"
              role="textbox"
              onblur={closeDropdown}
              placeholder={placeholder}
              title={fullLabel}
              onclick={handleInputClick}
              value={label}
              readonly
              disabled={disabled}
            />
            <!-- Up Arrow icon div if dropdown open -->
            <div
              if:true={isDropdownOpen}
              class="comboBoxIconOpen"
              onclick={closeDropdown}
            >
              <span
                if:false={useCustomIcon}
                class="slds-icon_container slds-icon-utility-up slds-input__icon slds-input__icon_right"
              >
                <lightning-icon icon-name={sldsIconUp} size="x-small">
                </lightning-icon>
              </span>
              <div if:true={useCustomIcon} class="customIconContainer">
                <img class="customIconStyle" src={customIconUp} alt="" />
              </div>
            </div>
            <!-- Down Arrow icon div if dropdown close -->
            <div
              if:false={isDropdownOpen}
              class="comboBoxIconClose"
              onclick={handleInputIconClick}
            >
              <span
                if:false={useCustomIcon}
                class="slds-icon_container slds-icon-utility-down slds-input__icon slds-input__icon_right"
              >
                <lightning-icon icon-name={sldsIconDown} size="x-small">
                </lightning-icon>
              </span>
              <div if:true={useCustomIcon} class="customIconContainer">
                <img class="customIconStyle" src={customIconDown} alt="" />
              </div>
            </div>
          </div>
          <!-- List box to show dropdown options -->
          <div
            id="listbox-id-11"
            class="slds-dropdown slds-dropdown_fluid"
            role="listbox"
          >
            <ul
              class="slds-listbox slds-listbox_vertical slds-dropdown_length-5 customULClass"
              tabindex="0"
              role="presentation"
            >
              <template for:each={optionsToDisplay} for:item="option">
                <!-- li to display each option in the list -->
                <li
                  key={option.value}
                  role="presentation"
                  class="slds-listbox__item "
                  data-full-label={option.fullLabel}
                  data-label={option.label}
                  data-value={option.value}
                  onmousedown={optionsClickHandler}
                  title={option.fullLabel}
                >
                  <div
                    id={option.value}
                    class="slds-media slds-listbox__option slds-listbox__option_plain slds-media_small "
                    role="option"
                    data-id={option.value}
                  >
                    <span class="slds-media__body">
                      <span
                        class="slds-listbox__option-text slds-listbox__option-text_entity"
                      >
                        {option.label}
                      </span>
                      <span
                        if:true={option.meta}
                        class="slds-listbox__option-meta slds-listbox__option-meta_entity slds-truncate"
                      >
                        {option.meta}
                      </span>
                    </span>
                  </div>
                </li>
              </template>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>