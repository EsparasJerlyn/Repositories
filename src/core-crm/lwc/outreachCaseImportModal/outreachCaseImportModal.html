<template>
  <template if:true={modalOpen}>

  
    <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class={modalClass}>
      <div class="slds-modal__container">
        <button onclick={closeModal} class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse">
          <svg class="slds-button__icon slds-button__icon_large" aria-hidden="true">
            <use xlink:href="/assets/icons/utility-sprite/svg/symbols.svg#close"></use>
          </svg>
          <span class="slds-assistive-text">Cancel and close</span>
        </button>
        <div class="slds-modal__header">
          <h1 id="modal-heading-01" class="slds-modal__title slds-hyphenate">Import List</h1>
        </div>
        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
          <div class="slds-form">

            <div if:false={showCaseCol} class="slds-form-element slds-form-element_horizontal">
              <label class="slds-form-element__label" for="horizontal-input-id-01">Engagement List Criteria Title</label>
              <div class="slds-form-element__control">
                <lightning-input onchange={handleTitle} placeholder="Placeholder text…"></lightning-input>
              </div>
            </div>

            <div if:false={showCaseCol} class="slds-form-element slds-form-element_horizontal">
              <label class="slds-form-element__label" for="horizontal-input-id-02">Description</label>
              <div class="slds-form-element__control">
                <lightning-input placeholder="Placeholder text…" onchange={handleDescription}></lightning-input>
                <div class="slds-grid slds-gutters">
                  <div class="slds-p-left_small">
                    <lightning-input
                      type="file"
                      accept=".csv"
                      onchange={handleFileUpload}>
                    </lightning-input>
                  </div>
                  <div style="color:blue" class="slds-text-body_small slds-text-align_left slds-p-vertical_medium slds-p-left_small">{fileName}</div>
                </div>
              </div>
            </div>

            <div if:true={showTabset}>
              <template if:false={loaded}>
                <lightning-spinner alternative-text="Loading"></lightning-spinner>
              </template>
              <template if:true={loaded}>
                <div class="slds-box slds-p-around_none slds-m-top_x-small slds-m-bottom_medium slds-m-horizontal_none">
                  <lightning-layout>
                    <lightning-layout-item flexibility="auto" padding="around-small">
                        <div class="custom-box">Summary</div>
                    </lightning-layout-item>
                    <lightning-layout-item flexibility="auto" padding="around-small">
                        <div class="custom-box">{column2Name}: {studentsFound} </div>
                    </lightning-layout-item>
                    <lightning-layout-item flexibility="auto" padding="around-small">
                        <div class="custom-box">{column3Name}: {studentsFound} </div>
                    </lightning-layout-item>
                    <lightning-layout-item flexibility="auto" padding="around-small">
                        <div class="custom-box">Exclusions: {exclRowCount} </div>
                    </lightning-layout-item>
                  </lightning-layout>
                </div>
                <lightning-tabset if:true={loaded}>
                  <lightning-tab label="Students Found" title="Students Found">
                    <div class="slds-grid slds-grid_vertical slds-clearfix">
                      <div class="slds-col slds-float_right">
                        <lightning-input 
                          class="slds-p-bottom_large"
                          name="Search"
                          type="search"
                          placeholder="search"
                          onchange={handleSearch}
                        ></lightning-input>
                      </div>
                      <lightning-card>
                          <c-custom-datatable-columned
                            key-field="id"
                            onload={addBlankRow}
                            data={data}
                            columns={studentTable}
                            onrowaction={handleActionRow}
                            draft-values={draftValues}
                            hide-checkbox-column
                            show-row-number-column
                            suppress-bottom-bar
                          ></c-custom-datatable-columned>
                      </lightning-card>
                    </div>
                  </lightning-tab>
                  <lightning-tab label="Exclusions" title="Exclusions">
                    <div class="slds-grid slds-grid_vertical slds-clearfix">
                      <lightning-card>
                          <c-custom-datatable-columned
                            key-field="id"
                            onload={addBlankRow}
                            data={exclusionData}
                            columns={exclusionsTable}
                            draft-values={draftValues}
                            hide-checkbox-column
                            show-row-number-column
                            suppress-bottom-bar
                          ></c-custom-datatable-columned>
                      </lightning-card>
                    </div>
                  </lightning-tab>
                </lightning-tabset>
              </template>
            </div>
            
            <template if:true={errors.length}>
              <div class="slds-text-color_error slds-m-top_medium">
                <ul>
                    <template for:each={errors} for:item="error">
                        <li key={error}>{error}</li>
                    </template>
                </ul>
              </div>
            </template>

          </div>
        </div>

        <div class="slds-modal__footer">
          <button class="slds-button slds-button_neutral" aria-label="Cancel and close" onclick={closeModal}>{exitModal}</button>
          <template if:true={showCreateOutreach}>
            <button class="slds-button slds-button_brand" disabled={createButtonDisbaled} onclick={handleCreateOutreach}>Create Outreach</button>
          </template>
        </div>

      </div>
    </section>
    <div class={backdropClass} role="presentation"></div>

  </template>
</template>